{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "CustomerProfile",
  "type": "object",
  "properties": {
    "id": { "type": "string", "format": "uuid" },
    "firstName": { "type": "string", "minLength": 1 },
    "middleName": { "type": "string", "minLength": 1 },
    "lastName": { "type": "string", "minLength": 1 },
    "emails": {
      "type": "array",
      "items": { "type": "string", "format": "email" },
      "minItems": 1,
      "uniqueItems": true
    },
    "phoneNumbers": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/PhoneNumber"
      },
      "minItems": 1
    },
    "address": { "$ref": "#/definitions/PostalAddress" },
    "privacySettings": { "$ref": "#/definitions/PrivacySettings" }
  },
  "required": ["id", "firstName", "lastName", "emails", "privacySettings"],
  "additionalProperties": false,
  "definitions": {
    "PhoneNumber": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["mobile", "home", "work", "other"] },
        "number": { "type": "string", "pattern": "^\\+?[1-9]\\d{1,14}$" }
      },
      "required": ["type", "number"],
      "additionalProperties": false
    },
    "PostalAddress": {
      "type": "object",
      "properties": {
        "line1": { "type": "string", "minLength": 1 },
        "line2": { "type": "string" },
        "city": { "type": "string", "minLength": 1 },
        "state": { "type": "string", "minLength": 1 },
        "postalCode": { "type": "string" },
        "country": { "type": "string", "minLength": 2, "maxLength": 2 }
      },
      "required": ["line1", "city", "state", "postalCode", "country"],
      "additionalProperties": false
    },
    "PrivacySettings": {
      "type": "object",
      "properties": {
        "marketingEmailsEnabled": { "type": "boolean" },
        "twoFactorEnabled": { "type": "boolean" }
      },
      "required": ["marketingEmailsEnabled", "twoFactorEnabled"],
      "additionalProperties": false
    }
  }
}
